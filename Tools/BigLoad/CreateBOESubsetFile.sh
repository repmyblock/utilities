#!/bin/bash

array=( NODATA 20151215 20170515 20180127 20180423 20180529 20180924 20181029 20181203 20190204 20190225 20190325 \
				20190408 20190513 20190617 20190702 20190805 20190903 20191021 20191125 20191209 20200113 20200203 \
				20200218 20200309 20200406 20200420 20200615 20200717 20200721 20201005 20201116 20201221 20210119 \
				20210222 20210308 20210405 20210614 20210816 20210927 20211018 20211122 20220214 20220305 20220316 \
				20220425 20220516 20220613 20220801 20220822 20220919 20221107 20221205 20221227 )

#ADDSPECIAL=""
ADDSPECIAL="|NY000000000038885312|NY000000000038885380|NY000000000054072076|NY000000000055721503|NY000000000055391337"

MYSQL="mysql -h 192.168.199.18 -u usracct --password=usracct"
  
for i in "${array[@]}"				
do
	cat /dev/null > ~/Test/TestData/$i.txt
done

for j in "${array[@]}"
do
	RESULT=`${MYSQL} RawVoterFiles -e "SELECT UniqNYSVoterID FROM RawVoterFiles.NY_Raw_20151215 ORDER BY RAND() LIMIT 50"`

	firstime=""
	SEARCHSTRING="("
	for code in ${RESULT}
	do
		if [ $code != "UniqNYSVoterID" ]; then
			if [ ! -z $firstime ]; then
				SEARCHSTRING+="|";
			fi
			SEARCHSTRING+="${code}"
			firstime="done"
		fi
	done
	
	SEARCHSTRING+=${ADDSPECIAL}
	SEARCHSTRING+=")"

	array=("${array[@]:1}")		
	for i in "${array[@]}"
	do
		echo "$i "
		egrep ${SEARCHSTRING} /home/usracct/VoterFiles/NY/$i/AllNYSVoters_$i.txt >> ~/Test/TestData/$i.txt 
	done
	ADDSPECIAL=""
done